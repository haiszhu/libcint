function f = cgtofunc_nh3_dimer_ccpvdz(x,y,z)
% implement cgto, which calls libcint, libcgto, np_helper, etc...
% 
%
% nh3_dimer, ccpvdz
% geom='''
%         N  -1.578718  -0.046611   0.000000 
%         H  -2.158621   0.136396  -0.809565
%         H  -2.158621   0.136396   0.809565
%         H  -0.849471   0.658193   0.000000
%         N   1.578718   0.046611   0.000000
%         H   2.158621  -0.136396  -0.809565
%         H   0.849471  -0.658193   0.000000
%         H   2.158621  -0.136396   0.809565
%         '''
% 
% mol_nh3_dimer = gto.M(
%         verbose=7, 
%         atom=geom, 
%         basis='ccpvdz')
%
% use parameters from pyscf/pyscf/gto/eval_gto.py
% 
%
% 01/19/25 Hai

% respect the shape of input variables
nd = 58;
[n1,n2,n3] = size(x);
f = zeros([n1 n2 n3 nd]); % need to be changed later

persistent ngrids shls_slice ao_loc non0tab atm bas env natm nbas nao triuidx triflag;
if isempty(ngrids)
  ngrids = 1; 
  shls_slice = [0, 28];
  ao_loc = [ 0,  2,  3,  6,  9, 14, 15, 16, 19, 20, 21, 24, 25, 26, 29, 31, 32, 35, 38, 43, 44, 45, 48, 49, 50, 53, 54, 55, 58];
  non0tab = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];
  atm = [
    7, 20,  1, 23,  0,  0,...
    1, 24,  1, 27,  0,  0,...
    1, 28,  1, 31,  0,  0,...
    1, 32,  1, 35,  0,  0,...
    7, 36,  1, 39,  0,  0,...
    1, 40,  1, 43,  0,  0,...
    1, 44,  1, 47,  0,  0,...
    1, 48,  1, 51,  0,  0];
  bas = [
    0,  0,  8,  2,  0, 52, 60,  0,...
    0,  0,  1,  1,  0, 76, 77,  0,...
    0,  1,  3,  1,  0, 78, 81,  0,...
    0,  1,  1,  1,  0, 84, 85,  0,...
    0,  2,  1,  1,  0, 86, 87,  0,...
    1,  0,  3,  1,  0, 88, 91,  0,...
    1,  0,  1,  1,  0, 94, 95,  0,...
    1,  1,  1,  1,  0, 96, 97,  0,...
    2,  0,  3,  1,  0, 88, 91,  0,...
    2,  0,  1,  1,  0, 94, 95,  0,...
    2,  1,  1,  1,  0, 96, 97,  0,...
    3,  0,  3,  1,  0, 88, 91,  0,...
    3,  0,  1,  1,  0, 94, 95,  0,...
    3,  1,  1,  1,  0, 96, 97,  0,...
    4,  0,  8,  2,  0, 52, 60,  0,...
    4,  0,  1,  1,  0, 76, 77,  0,...
    4,  1,  3,  1,  0, 78, 81,  0,...
    4,  1,  1,  1,  0, 84, 85,  0,...
    4,  2,  1,  1,  0, 86, 87,  0,...
    5,  0,  3,  1,  0, 88, 91,  0,...
    5,  0,  1,  1,  0, 94, 95,  0,...
    5,  1,  1,  1,  0, 96, 97,  0,...
    6,  0,  3,  1,  0, 88, 91,  0,...
    6,  0,  1,  1,  0, 94, 95,  0,...
    6,  1,  1,  1,  0, 96, 97,  0,...
    7,  0,  3,  1,  0, 88, 91,  0,...
    7,  0,  1,  1,  0, 94, 95,  0,...
    7,  1,  1,  1,  0, 96, 97,  0];
  env = [
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
   -2.98334465e+00, -8.80820244e-02,  0.00000000e+00,  0.00000000e+00, ...
   -4.07920250e+00,  2.57751084e-01, -1.52985613e+00,  0.00000000e+00, ...
   -4.07920250e+00,  2.57751084e-01,  1.52985613e+00,  0.00000000e+00, ...
   -1.60526754e+00,  1.24380451e+00,  0.00000000e+00,  0.00000000e+00, ...
    2.98334465e+00,  8.80820244e-02,  0.00000000e+00,  0.00000000e+00, ...
    4.07920250e+00, -2.57751084e-01, -1.52985613e+00,  0.00000000e+00, ...
    1.60526754e+00, -1.24380451e+00,  0.00000000e+00,  0.00000000e+00, ...
    4.07920250e+00, -2.57751084e-01,  1.52985613e+00,  0.00000000e+00, ...
    9.04600000e+03,  1.35700000e+03,  3.09300000e+02,  8.77300000e+01, ...
    2.85600000e+01,  1.02100000e+01,  3.83800000e+00,  7.46600000e-01, ...
    1.63952511e+00,  3.04243049e+00,  5.10397088e+00,  7.47046862e+00, ...
    8.69498936e+00,  6.46916279e+00,  1.92651664e+00,  3.13141682e-02, ...
   -7.14731953e-01, -1.36022624e+00, -2.22569718e+00, -3.54336401e+00, ...
   -4.19727941e+00, -4.54726296e+00, -1.68246433e+00,  2.22075187e+00, ...
    2.24800000e-01,  8.24825833e-01,  1.35500000e+01,  2.91700000e+00, ...
    7.97300000e-01,  4.46751132e+00,  3.56393896e+00,  1.65512513e+00, ...
    2.18500000e-01,  4.35811508e-01,  8.17000000e-01,  1.83196843e+00, ...
    1.30100000e+01,  1.96200000e+00,  4.44600000e-01,  5.79764064e-01, ...
    9.83419580e-01,  1.11930215e+00,  1.22000000e-01,  5.21536727e-01, ...
    7.27000000e-01,  1.95840453e+00];
  natm = numel(atm)/6;
  nbas = numel(bas)/8;
  nao = ao_loc(shls_slice(2)+1) - ao_loc(shls_slice(1)+1);
end

% nx,ny,nz,nd
for ix = 1:n1
  for iy = 1:n2
    for iz = 1:n3
      xyz = [x(ix,iy,iz); y(ix,iy,iz); z(ix,iy,iz)];
      fi = zeros(nd,1);
      fi = GTOval_nh3_dimer_ccpvdz_mwrap_mex(ngrids, shls_slice, ao_loc, fi, xyz, non0tab, atm, natm, bas, nbas, env);
      f(ix,iy,iz,:) = fi;
    end
  end
end
end