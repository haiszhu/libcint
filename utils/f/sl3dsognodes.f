c*********************************************************************
C
C     get sum-of-Gaussian approximation nodes and weights for 
c     the 1/r^2 kernel in 3D, i.e., Green's function for the
c     square root Laplacian.
C
C*********************************************************************
      subroutine sl3dsognodes(eps,n,ws,ts)
      implicit real *8 (a-h,o-z)
      real *8 eps
      real *8 ws(*),ts(*)
c     r\in [1/2^16,sqrt(3)], 3 digits
      real *8 ws0(30),ts0(30)
      
c     r\in [1/2^16,sqrt(3)], 6 digits
      real *8 ws1(52),ts1(52)
      
c     r\in [1/2^16,sqrt(3)], 9 digits
      real *8 ws2(74),ts2(74)

c     r\in [1/2^16,sqrt(3)], 12 digits
      real *8 ws3(97),ts3(97)

c
c Data for 30 nodes
c
c      Nodes:
c
      data ts0/
     1  3.605010717030962D+01,8.160198792545335D+00,
     2  2.999999999999966D+00,1.116850216463423D+00,
     3  4.157848020048084D-01,1.547897820404300D-01,
     4  5.762566719272797D-02,2.145307962601621D-02,
     5  7.986625541374541D-03,2.973288154898880D-03,
     6  1.106905839802339D-03,4.120826755960167D-04,
     7  1.534115418133930D-04,5.711257122742909D-05,
     8  2.126206251271207D-05,7.915513039927451D-06,
     9  2.946814150687389D-06,1.097050007357571D-06,
     *  4.084135127295066D-07,1.520455733661819D-07,
     1  5.660404384210974D-08,2.107274620592213D-08,
     2  7.845033720521432D-09,2.920575869642363D-09,
     3  1.087281930735995D-09,4.047770198997673D-10,
     4  1.506917674314945D-10,5.610004435837398D-11,
     5  2.088511556175292D-11,7.775181945335944D-12/
c
c      Weights:
c
      data ws0/
     1  6.608016772555755D-02,1.291870714127813D-01,
     2  3.293666240182240D-01,8.847201330036257D-01,
     3  2.376469431519082D+00,6.383495467398244D+00,
     4  1.714687083361625D+01,4.605864935383876D+01,
     5  1.237193188707586D+02,3.323256343071347D+02,
     6  8.926684064031148D+02,2.397819492473892D+03,
     7  6.440844413496737D+03,1.730091730802893D+04,
     8  4.647243753816683D+04,1.248308059212945D+05,
     9  3.353112281696440D+05,9.006880866211987D+05,
     *  2.419361361114119D+06,6.498708579137345D+06,
     1  1.745634772686647D+07,4.688994317109773D+07,
     2  1.259522785058281D+08,3.383236444310052D+08,
     3  9.087798151725047D+08,2.441096760629666D+09,
     4  6.557092593023389D+09,1.761317452340270D+10,
     5  4.731119964996353D+10,1.270838263337853D+11/
c
c Data for 52 nodes
c
c      Nodes:
c
      data ts1/
     1  9.394771931190643D+01,2.012147077215335D+01,
     2  9.531658447893321D+00,5.321378633010857D+00,
     3  3.000000000007307D+00,1.691371104451221D+00,
     4  9.535787376552269D-01,5.376185075632117D-01,
     5  3.031041363040510D-01,1.708871925948257D-01,
     6  9.634455322508249D-02,5.431813113199632D-02,
     7  3.062403914815774D-02,1.726553830560221D-02,
     8  9.734144197629233D-03,5.488016740808475D-03,
     9  3.094090978715249D-03,1.744418691980343D-03,
     *  9.834864565570224D-04,5.544801914158815D-04,
     1  3.126105912512655D-04,1.762468403292073D-04,
     2  9.936627099416619D-05,5.602174650522371D-05,
     3  3.158452108645851D-05,1.780704877111796D-05,
     4  1.003944258232409D-05,5.660141029520598D-06,
     5  3.191132994826527D-06,1.799130045978391D-06,
     6  1.014332190975228D-06,5.718707193766767D-07,
     7  3.224152034117408D-07,1.817745862288456D-07,
     8  1.024827608903838D-07,5.777879349146427D-08,
     9  3.257512725383492D-08,1.836554298698183D-08,
     *  1.035431624191057D-08,5.837663765971037D-09,
     1  3.291218603754329D-09,1.855557348275965D-09,
     2  1.046145360510917D-09,5.898066779414622D-10,
     3  3.325273240936875D-10,1.874757024705609D-10,
     4  1.056969953150251D-10,5.959094790101529D-11,
     5  3.359680245553183D-11,1.894155362507593D-11,
     6  1.067906549161998D-11,6.020754265021475D-12/
c
c      Weights:
c
      data ws1/
     1  2.651275029119808D-02,4.848290206585300D-02,
     2  6.414254797406636D-02,1.077559404510468D-01,
     3  1.910242614178412D-01,3.388214347215642D-01,
     4  6.009705980483028D-01,1.065946905082644D+00,
     5  1.890679524338111D+00,3.353515120429604D+00,
     6  5.948159652746260D+00,1.055030378091310D+01,
     7  1.871316783133879D+01,3.319171253800156D+01,
     8  5.887243630452820D+01,1.044225648935472D+02,
     9  1.852152338751936D+02,3.285179108022980D+02,
     *  5.826951458527755D+02,1.033531572679197D+03,
     1  1.833184160386749D+03,3.251535081058395D+03,
     2  5.767276748187957D+03,1.022947016129314D+04,
     3  1.814410238133571D+04,3.218235607835294D+04,
     4  5.708213175725470D+04,1.012470857638691D+05,
     5  1.795828582445887D+05,3.185277159538287D+05,
     6  5.649754482324597D+05,1.002101987104253D+06,
     7  1.777437224390827D+06,3.152656243880928D+06,
     8  5.591894473514266D+06,9.918393057798052D+06,
     9  1.759234215075520D+07,3.120369404052260D+07,
     *  5.534627017999160D+07,9.816817261632048D+07,
     1  1.741217625592780D+08,3.088413218724335D+08,
     2  5.477946047308451D+08,9.716281718862641D+08,
     3  1.723385546788666D+09,3.056784301661341D+09,
     4  5.421845555272229D+09,9.616775776180521D+09,
     5  1.705736089059270D+10,3.025479301207911D+10,
     6  5.366319597005497D+10,9.518288889204677D+10/
c
c Data for 74 nodes
c
c      Nodes:
c
      data ts2/
     1  1.797038151694525D+02,3.639086511184887D+01,
     2  1.658991707280776D+01,1.014018882043205D+01,
     3  6.725063833625920D+00,4.491458880708316D+00,
     4  2.999999998860257D+00,2.003803522892357D+00,
     5  1.338409520330105D+00,8.939699047947913D-01,
     6  5.971133487453629D-01,3.988326109338263D-01,
     7  2.663940638381573D-01,1.779337880149756D-01,
     8  1.188481171850960D-01,7.938275869756869D-02,
     9  5.302248388577552D-02,3.541554669419116D-02,
     *  2.365526576126534D-02,1.580016830085809D-02,
     1  1.055347764235160D-02,7.049031898060885D-03,
     2  4.708291653477403D-03,3.144830469395538D-03,
     3  2.100540792633290D-03,1.403023681376472D-03,
     4  9.371279327199742D-04,6.259400847713158D-04,
     5  4.180869826799641D-04,2.792547233865073D-04,
     6  1.865238665507307D-04,1.245857271439074D-04,
     7  8.321510637055114D-05,5.558224110973936D-05,
     8  3.712529684548338D-05,2.479726686505453D-05,
     9  1.656295023120786D-05,1.106296601003745D-05,
     *  7.389336761960840D-06,4.935593018264500D-06,
     1  3.296652895988859D-06,2.201948230409436D-06,
     2  1.470757207921130D-06,9.823694921269175D-07,
     3  6.561584834892224D-07,4.382708939151532D-07,
     4  2.927362539523886D-07,1.955286457944818D-07,
     5  1.306003298533948D-07,8.723246708162400D-08,
     6  5.826557499050550D-08,3.891758816502098D-08,
     7  2.599440009838930D-08,1.736255683384907D-08,
     8  1.159705085272760D-08,7.746070455570875D-09,
     9  5.173867759435105D-09,3.455804816300859D-09,
     *  2.308251289408426D-09,1.541760689449665D-09,
     1  1.029795168114429D-09,6.878357294917578D-10,
     2  4.594292197982012D-10,3.068686299183762D-10,
     3  2.049681473762276D-10,1.369052987509038D-10,
     4  9.144377343217140D-11,6.107845185126677D-11,
     5  4.079640569925549D-11,2.724932717434094D-11,
     6  1.820076594289790D-11,1.215691964758026D-11,
     7  8.120026145140159D-12,5.423645669229385D-12/
c
c      Weights:
c
      data ws2/
     1  1.406439838262613D-02,2.866337027857712D-02,
     2  3.575354166922987D-02,4.216356115865263D-02,
     3  6.008747439671676D-02,8.985191920361517D-02,
     4  1.345217175074833D-01,2.013995621988723D-01,
     5  3.015259124807678D-01,4.514303553148108D-01,
     6  6.758602076049122D-01,1.011865982897969D+00,
     7  1.514917960460822D+00,2.268063622979825D+00,
     8  3.395637738986872D+00,5.083788451831075D+00,
     9  7.611207970427879D+00,1.139514110736428D+01,
     *  1.706026709024287D+01,2.554182615615473D+01,
     1  3.824001581800791D+01,5.725114566309633D+01,
     2  8.571371141323873D+01,1.283265206216516D+02,
     3  1.921244059307903D+02,2.876395866090106D+02,
     4  4.306404043418944D+02,6.447344752430092D+02,
     5  9.652660050157498D+02,1.445150670304470D+03,
     6  2.163611329336057D+03,3.239256702919648D+03,
     7  4.849662158356196D+03,7.260685151724827D+03,
     8  1.087035491013835D+04,1.627458199788840D+04,
     9  2.436553555749802D+04,3.647892904695939D+04,
     *  5.461452962141571D+04,8.176629434007024D+04,
     1  1.224166342686685D+05,1.832764034048802D+05,
     2  2.743927753494828D+05,4.108079040437312D+05,
     3  6.150421920349130D+05,9.208121223410708D+05,
     4  1.378596420943979D+06,2.063969452346954D+06,
     5  3.090077585803445D+06,4.626318221744440D+06,
     6  6.926305149058225D+06,1.036973695662676D+07,
     7  1.552508043838122D+07,2.324341722491223D+07,
     8  3.479894651367301D+07,5.209933918707584D+07,
     9  7.800067006673090D+07,1.167789194521021D+08,
     *  1.748358829525216D+08,2.617560264923881D+08,
     1  3.918887599441749D+08,5.867173427358409D+08,
     2  8.784054964386507D+08,1.315107224385885D+09,
     3  1.968916424252003D+09,2.947768677466873D+09,
     4  4.413260043043623D+09,6.607324506745479D+09,
     5  9.892174200694710D+09,1.481009602183194D+10,
     6  2.217297630481964D+10,3.319633292626216D+10,
     7  4.969998184304991D+10,7.440846555816106D+10/
c
c Data for 97 nodes
c
c      Nodes:
c
      data ts3/
     1  2.935488227978228D+02,5.794320725478870D+01,
     2  2.532149731035635D+01,1.509481273585952D+01,
     3  1.048248182481414D+01,7.637478061035402D+00,
     4  5.592915767882117D+00,4.096185366441645D+00,
     5  2.999999404999838D+00,2.197165456648615D+00,
     6  1.609179171448145D+00,1.178544718234634D+00,
     7  8.631528312036575D-01,6.321633067690509D-01,
     8  4.629891847831491D-01,3.390879947787568D-01,
     9  2.483441865357985D-01,1.818844600212645D-01,
     *  1.332101130137076D-01,9.756157378435830D-02,
     1  7.145298815946978D-02,5.233135646841187D-02,
     2  3.832689065092804D-02,2.807017905158808D-02,
     3  2.055828006250509D-02,1.505665063091751D-02,
     4  1.102731977248122D-02,8.076283653342809D-03,
     5  5.914978344215693D-03,4.332062908111806D-03,
     6  3.172753639640950D-03,2.323688625863126D-03,
     7  1.701842874031841D-03,1.246410023610330D-03,
     8  9.128562556668448D-04,6.685653239761651D-04,
     9  4.896494503829130D-04,3.586136653470753D-04,
     *  2.626447908751571D-04,1.923583872849884D-04,
     1  1.408813401715777D-04,1.031799853624400D-04,
     2  7.556785087192935D-05,5.534501719774341D-05,
     3  4.053404835239234D-05,2.968666675236421D-05,
     4  2.174216846485610D-05,1.592370898577643D-05,
     5  1.166233697829359D-05,8.541358577636493D-06,
     6  6.255591439816169D-06,4.581523038198356D-06,
     7  3.355455131724767D-06,2.457497171251677D-06,
     8  1.799843006120487D-06,1.318184572357954D-06,
     9  9.654234047071877D-07,7.070651298679404D-07,
     *  5.178464641751381D-07,3.792648639912821D-07,
     1  2.777692752656448D-07,2.034350597893165D-07,
     2  1.489935253344525D-07,1.091211643390398D-07,
     3  7.991910038178396D-08,5.853184079425380D-08,
     4  4.286805553895922D-08,3.139607797462338D-08,
     5  2.299413048143582D-08,1.684063382447274D-08,
     6  1.233387606313998D-08,9.033175936671137D-09,
     7  6.615784105264782D-09,4.845318643776098D-09,
     8  3.548653371992128D-09,2.598992782049993D-09,
     9  1.903473819242656D-09,1.394084416131388D-09,
     *  1.021013256739827D-09,7.477796004502994D-10,
     1  5.476658507216171D-10,4.011044972911265D-10,
     2  2.937644720964509D-10,2.151497880173034D-10,
     3  1.575732600163341D-10,1.154048599423682D-10,
     4  8.452120509669374D-11,6.190236939190002D-11,
     5  4.533659188870763D-11,3.320400469167719D-11,
     6  2.431823562391312D-11,1.781039934207676D-11,
     7  1.304413402578165D-11,9.553375487258899D-12,
     8  6.996783613209614D-12,5.124364785572486D-12,
     9  3.753026520074207D-12/
c
c      Weights:
c
      data ws3/
     1  8.662401582874452D-03,1.861513329573225D-02,
     2  2.516935588036950D-02,2.785564455463807D-02,
     3  3.124306933385963D-02,4.085168050766666D-02,
     4  5.568608275351630D-02,7.603270754217240D-02,
     5  1.038146978392782D-01,1.417480586094057D-01,
     6  1.935420512720976D-01,2.642613732948967D-01,
     7  3.608213371324537D-01,4.926639162666968D-01,
     8  6.726810772531899D-01,9.184755477207930D-01,
     9  1.254082082249538D+00,1.712317665337512D+00,
     *  2.337990447129227D+00,3.192281189662837D+00,
     1  4.358725784998573D+00,5.951383762317967D+00,
     2  8.125991466021553D+00,1.109519059293111D+01,
     3  1.514932113106990D+01,2.068481192817343D+01,
     4  2.824294506691490D+01,3.856278455986634D+01,
     5  5.265344492850113D+01,7.189276572543962D+01,
     6  9.816204616507373D+01,1.340300341359194D+02,
     7  1.830040967645203D+02,2.498730682370639D+02,
     8  3.411756055941993D+02,4.658398452169785D+02,
     9  6.360557067220135D+02,8.684657258722926D+02,
     *  1.185794055467632D+03,1.619072051763345D+03,
     1  2.210673051111368D+03,3.018449592362040D+03,
     2  4.121385198090422D+03,5.627323820465381D+03,
     3  7.683522987084119D+03,1.049105114307698D+04,
     4  1.432444271447987D+04,1.955854187549890D+04,
     5  2.670515706996875D+04,3.646310569033257D+04,
     6  4.978654743895995D+04,6.797829530401230D+04,
     7  9.281722038507943D+04,1.267321841245890D+05,
     8  1.730395239830381D+05,2.362673505868586D+05,
     9  3.225983330354344D+05,4.404742534013187D+05,
     *  6.014214791156087D+05,8.211780635220618D+05,
     1  1.121232671511693D+06,1.530925824148582D+06,
     2  2.090318930776616D+06,2.854111651536481D+06,
     3  3.896990641742881D+06,5.320932619471748D+06,
     4  7.265175730829106D+06,9.919835798001468D+06,
     5  1.354450434654926D+07,1.849364158176849D+07,
     6  2.525121669912967D+07,3.447799021858452D+07,
     7  4.707613531020492D+07,6.427752014700480D+07,
     8  8.776414937027025D+07,1.198325211311921D+08,
     9  1.636182282857434D+08,2.234028386474337D+08,
     *  3.050326342108995D+08,4.164899872998734D+08,
     1  5.686736984474705D+08,7.764648001551284D+08,
     2  1.060181875801838D+09,1.447567924958302D+09,
     3  1.976502966743666D+09,2.698708067657375D+09,
     4  3.684803169509187D+09,5.031212680116072D+09,
     5  6.869594030402457D+09,9.379711492847219D+09,
     6  1.280701410324968D+10,1.748663691964077D+10,
     7  2.387617192248454D+10,3.260041301475386D+10,
     8  4.451245083279793D+10,6.077709132767438D+10,
     9  8.298475507798955D+10/
      
c        
c        
      if (eps .ge. 0.9d-3) then
         n=30
         do j =1,n
            ts(j) = ts0(j)
            ws(j) = ws0(j)
         enddo
      elseif (eps.ge.0.9d-6) then
         n=52
         do j =1,n
            ts(j) = ts1(j)
            ws(j) = ws1(j)
         enddo
      elseif (eps.ge.0.9d-9) then
         n=74
         do j =1,n
            ts(j) = ts2(j)
            ws(j) = ws2(j)
         enddo
      elseif (eps.ge.0.9d-12) then
         n=97
         do j =1,n
            ts(j) = ts3(j)
            ws(j) = ws3(j)
         enddo
      endif
c
      return
      end
