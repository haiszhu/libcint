c*********************************************************************
C
C     get sum-of-Gaussian approximation nodes and weights for 
c     the log(r) kernel.
C
C*********************************************************************
      subroutine l2dsognodes(eps,n,ws,ts)
      implicit real *8 (a-h,o-z)
      real *8 eps
      real *8 ws(*),ts(*)
c     r\in [1/2^16,sqrt(3)], 3 digits
      real *8 ws0(39),xs0(39)
      
c     r\in [1/2^16,sqrt(3)], 6 digits
      real *8 ws1(71),xs1(71)
      
c     r\in [1/2^16,sqrt(3)], 9 digits
      real *8 ws2(94),xs2(94)

c     r\in [1/2^16,sqrt(3)], 12 digits
      real *8 ws3(114),xs3(114)

c
c Data for 39 nodes
c
c      Nodes:
c
      data xs0/
     1  2.527884739685798D+01,6.392802653930683D+00,
     2  3.000000000000018D+00,1.447550847147851D+00,
     3  6.984678183594120D-01,3.370225607238562D-01,
     4  1.626190977612414D-01,7.846647090889269D-02,
     5  3.786140214562015D-02,1.826876825003236D-02,
     6  8.814990318893740D-03,4.253382234571281D-03,
     7  2.052329018965635D-03,9.902835366756423D-04,
     8  4.778285908110050D-04,2.305603938065859D-04,
     9  1.112492977911062D-04,5.367967175404194D-05,
     *  2.590135144073469D-05,1.249784107343930D-05,
     1  6.030420144458314D-06,2.909779929588632D-06,
     2  1.404018134029433D-06,6.774625464416311D-07,
     3  3.268871610041789D-07,1.577285956111161D-07,
     4  7.610672073209985D-08,3.672278268979614D-08,
     5  1.771936506407918D-08,8.549893969809782D-09,
     6  4.125468753007347D-09,1.990608596099140D-09,
     7  9.605023865410198D-10,4.634586811083106D-10,
     8  2.236266688187527D-10,1.079036579644647D-10,
     9  5.206534383226702D-11,2.512241085714596D-11,
     *  1.212198903955189D-11/
c
c      Weights:
c
      data ws0/
     1  -1.171625713593186D+00,-4.271941334086007D-01,
     2  -3.643696156283854D-01,-3.643696156284152D-01,
     3  -3.643696156284588D-01,-3.643696156284100D-01,
     4  -3.643696156284277D-01,-3.643696156284463D-01,
     5  -3.643696156284045D-01,-3.643696156283926D-01,
     6  -3.643696156284154D-01,-3.643696156284210D-01,
     7  -3.643696156284176D-01,-3.643696156280213D-01,
     8  -3.643696156289969D-01,-3.643696156281738D-01,
     9  -3.643696156283215D-01,-3.643696156282989D-01,
     *  -3.643696156282839D-01,-3.643696156283861D-01,
     1  -3.643696156284802D-01,-3.643696156285509D-01,
     2  -3.643696156285468D-01,-3.643696156284027D-01,
     3  -3.643696156283803D-01,-3.643696156284072D-01,
     4  -3.643696156284166D-01,-3.643696156284191D-01,
     5  -3.643696156284156D-01,-3.643696156284156D-01,
     6  -3.643696156283889D-01,-3.643696156284169D-01,
     7  -3.643696156283749D-01,-3.643696156284416D-01,
     8  -3.643696156284696D-01,-3.643696156284341D-01,
     9  -3.643696156284170D-01,-3.643696156284188D-01,
     *  -3.643696156284172D-01/
      
c
c Data for 71 nodes
c
c      Nodes:
c
      data xs1/
     1  6.418047848780080D+01,1.387754831351396D+01,
     2  6.964580260208069D+00,4.498069526451979D+00,
     3  2.999999998214224D+00,2.001750459924986D+00,
     4  1.335668302122899D+00,8.912248802953656D-01,
     5  5.946699390057619D-01,3.967936087636352D-01,
     6  2.647605967372387D-01,1.766615489898130D-01,
     7  1.178774457864947D-01,7.865374388712984D-02,
     8  5.248172275866491D-02,3.501843762084989D-02,
     9  2.336605791077411D-02,1.559100574641664D-02,
     *  1.040310098893945D-02,6.941470739251398D-03,
     1  4.631697421293279D-03,3.090500818666715D-03,
     2  2.062137147878400D-03,1.375961329948727D-03,
     3  9.181104096101987D-04,6.126093123764682D-04,
     4  4.087636580687737D-04,2.727476137945113D-04,
     5  1.819908873771090D-04,1.214334477565411D-04,
     6  8.102648682734975D-05,5.406493588080889D-05,
     7  3.607483682209670D-05,2.407094044005576D-05,
     8  1.606133873108766D-05,1.071693075364956D-05,
     9  7.150873699274575D-06,4.771421574692186D-06,
     *  3.183731776470898D-06,2.124345514792982D-06,
     1  1.417469870257920D-06,9.458069891133619D-07,
     2  6.310898596430328D-07,4.210948064702515D-07,
     3  2.809755746937877D-07,1.874809955821557D-07,
     4  1.250967232175927D-07,8.347080785800706D-08,
     5  5.569590941625549D-08,3.716310414764581D-08,
     6  2.479708697390595D-08,1.654586010759623D-08,
     7  1.104022770852871D-08,7.366593641166992D-09,
     8  4.915360743196607D-09,3.279775214003433D-09,
     9  2.188430517337562D-09,1.460230600105878D-09,
     *  9.743390929857755D-10,6.501279099479416D-10,
     1  4.337979481623951D-10,2.894517478540764D-10,
     2  1.931367234192710D-10,1.288705084918255D-10,
     3  8.598886666916662D-11,5.737608454854429D-11,
     4  3.828420126411848D-11,2.554513919779789D-11,
     5  1.704499806935640D-11,1.137327759049098D-11,
     6  7.588821226264698D-12/
c
c      Weights:
c
      data ws1/
     1  -1.243337466852255D+00,-4.775538382475144D-01,
     2  -2.518458718999332D-01,-2.036393385458270D-01,
     3  -2.022951301157986D-01,-2.022951301921747D-01,
     4  -2.022951300749382D-01,-2.022951297891089D-01,
     5  -2.022951294984204D-01,-2.022951294941873D-01,
     6  -2.022951297268664D-01,-2.022951298916521D-01,
     7  -2.022951298265697D-01,-2.022951296547968D-01,
     8  -2.022951295521971D-01,-2.022951295699761D-01,
     9  -2.022951296752533D-01,-2.022951297596459D-01,
     *  -2.022951297833330D-01,-2.022951297834363D-01,
     1  -2.022951297834727D-01,-2.022951297834807D-01,
     2  -2.022951297834076D-01,-2.022951297833919D-01,
     3  -2.022951297896649D-01,-2.022951298399334D-01,
     4  -2.022951299505086D-01,-2.022951299046042D-01,
     5  -2.022951295849177D-01,-2.022951293014719D-01,
     6  -2.022951292647651D-01,-2.022951294206861D-01,
     7  -2.022951296389059D-01,-2.022951295785010D-01,
     8  -2.022951293740136D-01,-2.022951294901081D-01,
     9  -2.022951299526569D-01,-2.022951304228832D-01,
     *  -2.022951307101845D-01,-2.022951307024203D-01,
     1  -2.022951302930646D-01,-2.022951297324271D-01,
     2  -2.022951294345476D-01,-2.022951294696735D-01,
     3  -2.022951296220110D-01,-2.022951297464293D-01,
     4  -2.022951297939073D-01,-2.022951297880095D-01,
     5  -2.022951297815093D-01,-2.022951297824880D-01,
     6  -2.022951297832263D-01,-2.022951297834454D-01,
     7  -2.022951297833585D-01,-2.022951297821610D-01,
     8  -2.022951297766462D-01,-2.022951297783648D-01,
     9  -2.022951297998679D-01,-2.022951298317850D-01,
     *  -2.022951298710703D-01,-2.022951298495525D-01,
     1  -2.022951297455384D-01,-2.022951296988953D-01,
     2  -2.022951297505275D-01,-2.022951297706869D-01,
     3  -2.022951297597126D-01,-2.022951297717005D-01,
     4  -2.022951297813557D-01,-2.022951297830037D-01,
     5  -2.022951297834598D-01,-2.022951297833683D-01,
     6  -2.022951297834003D-01/

c
c Data for 94 nodes
c
c      Nodes:
c
      data xs2/
     1  1.221008591333058D+02,2.477631069552094D+01,
     2  1.135302779420883D+01,7.187693863511070D+00,
     3  5.244588112833896D+00,3.913374377381178D+00,
     4  2.889458543767769D+00,2.111918865993249D+00,
     5  1.533792145591747D+00,1.110274507739252D+00,
     6  8.026413704921892D-01,5.801414723753230D-01,
     7  4.195213732685149D-01,3.036474491091790D-01,
     8  2.200614077320377D-01,1.597628561564553D-01,
     9  1.162677568280723D-01,8.490756156928121D-02,
     *  6.231492777407940D-02,4.604574697255043D-02,
     1  3.430198834443736D-02,2.574729899829623D-02,
     2  1.941794537757168D-02,1.467013923548594D-02,
     3  1.108683412382435D-02,8.378931412874917D-03,
     4  6.330650046424563D-03,4.771586509399698D-03,
     5  3.568787790880583D-03,2.637392246886283D-03,
     6  1.927608047376645D-03,1.398495057492376D-03,
     7  1.010585679356252D-03,7.289859822466521D-04,
     8  5.255925807317109D-04,3.790132186217463D-04,
     9  2.734502029061753D-04,1.974169868358398D-04,
     *  1.426246547264458D-04,1.031118459092383D-04,
     1  7.459614646847788D-05,5.400130080006364D-05,
     2  3.911628286703911D-05,2.835066711478211D-05,
     3  2.055941790772536D-05,1.491741871775909D-05,
     4  1.082956829222376D-05,7.866304338193571D-06,
     5  5.717316143700975D-06,4.158280905547052D-06,
     6  3.026934036781069D-06,2.205835060724018D-06,
     7  1.609940912924648D-06,1.177632029658461D-06,
     8  8.642134375882933D-07,6.371787647945740D-07,
     9  4.727258837807364D-07,3.532228315353285D-07,
     *  2.655745726153227D-07,2.004057219675759D-07,
     1  1.514213803307058D-07,1.144363526035897D-07,
     2  8.648603532238368D-08,6.534878689543617D-08,
     3  4.928537164936341D-08,3.693532792542531D-08,
     4  2.739062625140322D-08,2.010359511114277D-08,
     5  1.464891185424336D-08,1.063089450346896D-08,
     6  7.700408513852558D-09,5.574363806794818D-09,
     7  4.035687711365789D-09,2.923040372790357D-09,
     8  2.118455605684107D-09,1.536385636255241D-09,
     9  1.115026555147183D-09,8.097921077573806D-10,
     *  5.885236518715164D-10,4.280163769524665D-10,
     1  3.115143602059432D-10,2.269084529853280D-10,
     2  1.654403792018963D-10,1.207704194453561D-10,
     3  8.830599771495734D-11,6.471731141199170D-11,
     4  4.758674707969448D-11,3.515348107438001D-11,
     5  2.612594902500865D-11,1.954671485580302D-11,
     6  1.470669978840964D-11,1.110046490101952D-11,
     7  8.387576710015369D-12,6.338911238751659D-12/
c
c      Weights:
c
      data ws2/
     1  -1.262988860035397D+00,-5.202840326487725D-01,
     2  -2.907277790485640D-01,-1.801069999509776D-01,
     3  -1.459793809907806D-01,-1.486616905333618D-01,
     4  -1.544976051127600D-01,-1.586385194897547D-01,
     5  -1.609553179317596D-01,-1.620202630518563D-01,
     6  -1.623425258589125D-01,-1.622405194710923D-01,
     7  -1.618823910119334D-01,-1.613345276834281D-01,
     8  -1.605890985588450D-01,-1.595718361842393D-01,
     9  -1.581372929719475D-01,-1.560689565594462D-01,
     *  -1.531346659145400D-01,-1.493053907428166D-01,
     1  -1.451686443558645D-01,-1.419619337696005D-01,
     2  -1.404373035225168D-01,-1.400568498953046D-01,
     3  -1.400163795234244D-01,-1.400323978160944D-01,
     4  -1.404378287185549D-01,-1.427762864249572D-01,
     5  -1.480773442128277D-01,-1.542493304813416D-01,
     6  -1.589247015961943D-01,-1.616713069343089D-01,
     7  -1.630132253490974D-01,-1.635151690690462D-01,
     8  -1.635592496171069D-01,-1.633696953583334D-01,
     9  -1.630703418831995D-01,-1.627272777450570D-01,
     *  -1.623747082919448D-01,-1.620294270291249D-01,
     1  -1.616987271902270D-01,-1.613847974364906D-01,
     2  -1.610870699945805D-01,-1.608032347105230D-01,
     3  -1.605294762872239D-01,-1.602602682383485D-01,
     4  -1.599877313074939D-01,-1.597004358165569D-01,
     5  -1.593812858824171D-01,-1.590038507418159D-01,
     6  -1.585263897793606D-01,-1.578827623594181D-01,
     7  -1.569700184715119D-01,-1.556361811320657D-01,
     8  -1.536850082961182D-01,-1.509473421846936D-01,
     9  -1.475020961989656D-01,-1.439894440221266D-01,
     *  -1.414473044536455D-01,-1.403134383963410D-01,
     1  -1.400437935642946D-01,-1.400160073560093D-01,
     2  -1.400277335676779D-01,-1.403328710479844D-01,
     3  -1.421839423307576D-01,-1.466681533670664D-01,
     4  -1.522630987164877D-01,-1.567529570497666D-01,
     5  -1.595094187257470D-01,-1.609124269889369D-01,
     6  -1.614742528784968D-01,-1.615648071862742D-01,
     7  -1.614082955747012D-01,-1.611309752890347D-01,
     8  -1.608008203656411D-01,-1.604525847569883D-01,
     9  -1.601021518395161D-01,-1.597541489121143D-01,
     *  -1.594056247333358D-01,-1.590472663741431D-01,
     1  -1.586624946514444D-01,-1.582244659800333D-01,
     2  -1.576906815667302D-01,-1.569945202981401D-01,
     3  -1.560339642699995D-01,-1.546622266208950D-01,
     4  -1.526986657241286D-01,-1.500089904321953D-01,
     5  -1.467225502480476D-01,-1.434890060763931D-01,
     6  -1.412358022922872D-01,-1.402640425806142D-01,
     7  -1.400386933686300D-01,-1.400158638027908D-01/

c
c Data for 114 nodes
c
c      Nodes:
c
      data xs3/
     1  2.690168133554699D+02,5.271649245189358D+01,
     2  2.272098239676576D+01,1.329958038066678D+01,
     3  9.237451910951119D+00,7.091520122099637D+00,
     4  5.609028261879542D+00,4.390854394291511D+00,
     5  3.392141787358265D+00,2.598181983721195D+00,
     6  1.980335420002666D+00,1.505505852953084D+00,
     7  1.143116944946349D+00,8.675731491317529D-01,
     8  6.584556334990579D-01,4.998820462278087D-01,
     9  3.796676562905312D-01,2.885332647720120D-01,
     *  2.194389146628357D-01,1.670532575823350D-01,
     1  1.273422382689682D-01,9.725463843880014D-02,
     2  7.448331113507181D-02,5.728390183684039D-02,
     3  4.433541562742545D-02,3.462769218539568D-02,
     4  2.736151912273625D-02,2.186808307141730D-02,
     5  1.760340489041034D-02,1.420479064330343D-02,
     6  1.146666712136154D-02,9.256511648481710D-03,
     7  7.470613574153701D-03,6.013897257586223D-03,
     8  4.794910511584431D-03,3.761900151769592D-03,
     9  2.906235995929712D-03,2.221122596870830D-03,
     *  1.686596655144808D-03,1.276190056567818D-03,
     1  9.639453867018055D-04,7.275546202972907D-04,
     2  5.490397506783450D-04,4.143834726862608D-04,
     3  3.128459307119108D-04,2.362758418316067D-04,
     4  1.785174754799126D-04,1.349328646026513D-04,
     5  1.020305008756632D-04,7.718211285253874D-05,
     6  5.840844049412912D-05,4.421819257871578D-05,
     7  3.348749084211453D-05,2.536934932720036D-05,
     8  1.922525751194471D-05,1.457351005416881D-05,
     9  1.105043923686925D-05,8.381373158885749D-06,
     *  6.358782344224207D-06,4.825783200765403D-06,
     1  3.663703681093900D-06,2.782728134918398D-06,
     2  2.114854903303441D-06,1.608590294580372D-06,
     3  1.224945475115287D-06,9.344096262822392D-07,
     4  7.146558745458413D-07,5.487969735730959D-07,
     5  4.240445575815529D-07,3.306322160990365D-07,
     6  2.608587983781371D-07,2.082826809197690D-07,
     7  1.676029808585043D-07,1.352360777140887D-07,
     8  1.091674522217563D-07,8.812596130226381D-08,
     9  7.112811848394929D-08,5.729649538651473D-08,
     *  4.578934416691920D-08,3.606947619036527D-08,
     1  2.799655880221541D-08,2.149708214203584D-08,
     2  1.639650278897251D-08,1.245912076040624D-08,
     3  9.448992062767512D-09,7.160115532655096D-09,
     4  5.424466533512349D-09,4.109934058693585D-09,
     5  3.114745455659264D-09,2.361333106971981D-09,
     6  1.790863895758822D-09,1.358795983916037D-09,
     7  1.031427076765807D-09,7.832665898237901D-10,
     8  5.950479219744226D-10,4.522192746927439D-10,
     9  3.437900629300459D-10,2.614504671283475D-10,
     *  1.989079156965492D-10,1.513925053746723D-10,
     1  1.152874332309945D-10,8.785020911127525D-11,
     2  6.700115554843100D-11,5.116296316839283D-11,
     3  3.913926347589608D-11,3.002278782006169D-11,
     4  2.312555301619789D-11,1.792488896472049D-11,
     5  1.401951962758943D-11,1.109035584868861D-11,
     6  8.869812017854300D-12,7.141757673013828D-12,
     7  5.763159063464032D-12,4.652260776058623D-12/
c
c      Weights:
c
      data ws3/
     1  -1.273546637015862D+00,-5.445206401619462D-01,
     2  -3.272504948675572D-01,-2.181866103262736D-01,
     3  -1.515865749256320D-01,-1.191591936578300D-01,
     4  -1.186918880822551D-01,-1.260894932830782D-01,
     5  -1.315504549757435D-01,-1.347921889345670D-01,
     6  -1.365657910484169D-01,-1.374614150596922D-01,
     7  -1.378449758215935D-01,-1.379323801685086D-01,
     8  -1.378488833816346D-01,-1.376623341463618D-01,
     9  -1.374021986893101D-01,-1.370707989050901D-01,
     *  -1.366473414607230D-01,-1.360852780079402D-01,
     1  -1.353033417304494D-01,-1.341688117914221D-01,
     2  -1.324727108797835D-01,-1.299067914090213D-01,
     3  -1.260904246762610D-01,-1.208078014892262D-01,
     4  -1.147056588530645D-01,-1.097957805697809D-01,
     5  -1.075697906306598D-01,-1.070960915644185D-01,
     6  -1.070570213602827D-01,-1.070675149395131D-01,
     7  -1.074345612995782D-01,-1.101121435355249D-01,
     8  -1.170269958282636D-01,-1.254980359375907D-01,
     9  -1.321414975851047D-01,-1.363385018657290D-01,
     *  -1.387214434968197D-01,-1.399684140601950D-01,
     1  -1.405487900865947D-01,-1.407505159992089D-01,
     2  -1.407425819137060D-01,-1.406237470299680D-01,
     3  -1.404515730521715D-01,-1.402572288558283D-01,
     4  -1.400557467197928D-01,-1.398535110821205D-01,
     5  -1.396522095487354D-01,-1.394521853198906D-01,
     6  -1.392562480480040D-01,-1.390698934092249D-01,
     7  -1.388966562890806D-01,-1.387352894612290D-01,
     8  -1.385828337510150D-01,-1.384377170075647D-01,
     9  -1.382982771179364D-01,-1.381596412182045D-01,
     *  -1.380129761459525D-01,-1.378464240334933D-01,
     1  -1.376446431242411D-01,-1.373865646604376D-01,
     2  -1.370410510531403D-01,-1.365585766766591D-01,
     3  -1.358577610477846D-01,-1.348056570799181D-01,
     4  -1.331918044220028D-01,-1.307031781292768D-01,
     5  -1.269416031236930D-01,-1.216388561011843D-01,
     6  -1.153528443065586D-01,-1.101140980072828D-01,
     7  -1.076459616979183D-01,-1.071030529569024D-01,
     8  -1.070571768659125D-01,-1.070641293306699D-01,
     9  -1.073336859879956D-01,-1.094411262966170D-01,
     *  -1.153677196679498D-01,-1.232322188815924D-01,
     1  -1.297636326738962D-01,-1.340498487585832D-01,
     2  -1.365583268428328D-01,-1.379068217841009D-01,
     3  -1.385491456578498D-01,-1.387832894935210D-01,
     4  -1.387978438299741D-01,-1.387021880742454D-01,
     5  -1.385505802824797D-01,-1.383660721459569D-01,
     6  -1.381590744302547D-01,-1.379387825871904D-01,
     7  -1.377180154797923D-01,-1.375106747766512D-01,
     8  -1.373238676561755D-01,-1.371524302430221D-01,
     9  -1.369825850014407D-01,-1.368008953027297D-01,
     *  -1.365976125741136D-01,-1.363618888643319D-01,
     1  -1.360746853710822D-01,-1.357026523567248D-01,
     2  -1.351915313461786D-01,-1.344555536557812D-01,
     3  -1.333593372571736D-01,-1.316925739319398D-01,
     4  -1.291495187083289D-01,-1.253633231788978D-01,
     5  -1.201570772349634D-01,-1.142351075691923D-01,
     6  -1.095791309293523D-01,-1.075207575227823D-01,
     7  -1.070917964506046D-01,-1.070569282834650D-01/
        
c        
c        
      if (eps .ge. 0.8d-3) then
         n=39
         do j =1,n
            ts(j) = xs0(j)
            ws(j) = ws0(j)
         enddo
      elseif (eps.ge.0.8d-6) then
         n=71
         do j =1,n
            ts(j) = xs1(j)
            ws(j) = ws1(j)
         enddo
      elseif (eps.ge.0.8d-9) then
         n=94
         do j =1,n
            ts(j) = xs2(j)
            ws(j) = ws2(j)
         enddo
      elseif (eps.ge.0.8d-12) then
         n=114
         do j =1,n
            ts(j) = xs3(j)
            ws(j) = ws3(j)
         enddo
      endif
c
      return
      end
