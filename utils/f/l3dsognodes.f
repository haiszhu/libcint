c*********************************************************************
C
C     get sum-of-Gaussian approximation nodes and weights for 
c     the 1/r kernel.
C
C*********************************************************************
      subroutine l3dsognodes(eps,n,ws,ts)
      implicit real *8 (a-h,o-z)
      real *8 eps
      real *8 ws(*),ts(*)
c     r\in [1/2^16,sqrt(3)], 3 digits
      real *8 ws0(26),ts0(26)
      
c     r\in [1/2^16,sqrt(3)], 6 digits
      real *8 ws1(48),ts1(48)
      
c     r\in [1/2^16,sqrt(3)], 9 digits
      real *8 ws2(70),ts2(70)

c     r\in [1/2^16,sqrt(3)], 12 digits
      real *8 ws3(92),ts3(92)

c
c Data for 26 nodes
c
c      Nodes:
c
      data ts0/
     1  6.968967180788766D+01,9.276988684948297D+00,
     2  2.999999999999901D+00,9.946766557386176D-01,
     3  3.297938831571355D-01,1.093460922605980D-01,
     4  3.625466845595350D-02,1.202055745822701D-02,
     5  3.985522630887779D-03,1.321435440620702D-03,
     6  4.381336616170762D-04,1.452671084345838D-04,
     7  4.816460053551269D-05,1.596940126188379D-05,
     8  5.294796880439504D-06,1.755536951283666D-06,
     9  5.820638745761452D-07,1.929884493965578D-07,
     *  6.398703514731767D-08,2.121547004365477D-08,
     1  7.034177597648697D-09,2.332244082900248D-09,
     2  7.732762482484865D-10,2.563866108566402D-10,
     3  8.500725888768172D-11,2.818491199463600D-11/
c
c      Weights:
c
      data ws0/
     1  2.601567703176558D-01,2.277579142884250D-01,
     2  3.595951139357155D-01,6.245014436256859D-01,
     3  1.084558821787227D+00,1.883531014896325D+00,
     4  3.271089601419862D+00,5.680834080189546D+00,
     5  9.865787789070296D+00,1.713371088206848D+01,
     6  2.975576354028626D+01,5.167622297121287D+01,
     7  8.974503433440455D+01,1.558583566018224D+02,
     8  2.706760045587465D+02,4.700774539222101D+02,
     9  8.163738527403515D+02,1.417779691149390D+03,
     *  2.462228850040075D+03,4.276102237756530D+03,
     1  7.426218869723994D+03,1.289696168021898D+04,
     2  2.239788827920972D+04,3.889795223144710D+04,
     3  6.755327417202949D+04,1.173183828343546D+05/
      
c
c Data for 48 nodes
c
c      Nodes:
c
      data ts1/
     1  1.977900480398362D+02,2.448395507214035D+01,
     2  1.033450208060229D+01,5.522990415680840D+00,
     3  2.999999999999691D+00,1.629706542197556D+00,
     4  8.853144712272312D-01,4.809342618871094D-01,
     5  2.612605709881570D-01,1.419260205859025D-01,
     6  7.709925475230571D-02,4.188305328946307D-02,
     7  2.275236198435006D-02,1.235989105878150D-02,
     8  6.714331773100463D-03,3.647463472377601D-03,
     9  1.981431694454488D-03,1.076384065123229D-03,
     *  5.847300509494458D-04,3.176461298172468D-04,
     1  1.725566586222501D-04,9.373890515212600D-05,
     2  5.092230232828578D-05,2.766280308273003D-05,
     3  1.502741705315397D-05,8.163426627954292D-06,
     4  4.434663260776222D-06,2.409066576176881D-06,
     5  1.308690519928210D-06,7.109271673462950D-07,
     6  3.862008852167781D-07,2.097980364134389D-07,
     7  1.139697441610680D-07,6.191241255729706D-08,
     8  3.363302126262129D-08,1.827065159519098D-08,
     9  9.925266811633490D-09,5.391757418658915D-09,
     *  2.928994113043685D-09,1.591133622694989D-09,
     1  8.643602914719704D-10,4.695512072758220D-10,
     2  2.550768914647780D-10,1.385668262612273D-10,
     3  7.527442109649962D-11,4.089173884036779D-11,
     4  2.221384476999460D-11,1.206734938300769D-11/
c
c      Weights:
c
      data ws1/
     1  1.582320073141624D-01,1.344618866729073D-01,
     2  1.177857644101955D-01,1.466522120106003D-01,
     3  1.987675166952444D-01,2.696816115586563D-01,
     4  3.658956595226119D-01,4.964359004075062D-01,
     5  6.735488568926575D-01,9.138502317198329D-01,
     6  1.239883695842263D+00,1.682235803915240D+00,
     7  2.282405446142904D+00,3.096697031687610D+00,
     8  4.201502639382923D+00,5.700468676085451D+00,
     9  7.734219377372683D+00,1.049354935109297D+01,
     *  1.423732281322405D+01,1.931675871587261D+01,
     1  2.620838005726116D+01,3.555871848526985D+01,
     2  4.824496811904856D+01,6.545727877601348D+01,
     3  8.881040887391961D+01,1.204952126308727D+02,
     4  1.634841732073588D+02,2.218102637087420D+02,
     5  3.009452971581622D+02,4.083132600234263D+02,
     6  5.539867872511361D+02,7.516321180244048D+02,
     7  1.019791182474067D+03,1.383621097226723D+03,
     8  1.877254259098973D+03,2.547000447137012D+03,
     9  3.455691335509630D+03,4.688574994064331D+03,
     *  6.361313364154523D+03,8.630832986185062D+03,
     1  1.171004693074354D+04,1.588782905886635D+04,
     2  2.155611447986513D+04,2.924666861329745D+04,
     3  3.968097431357959D+04,5.383791717593229D+04,
     4  7.304561886351206D+04,9.910603372187102D+04/

c
c Data for 70 nodes
c
c      Nodes:
c
      data ts2/
     1  3.914475788906666D+02,4.598539090171556D+01,
     2  1.846793521226799D+01,1.074718736947382D+01,
     3  6.973123877547384D+00,4.573365429511170D+00,
     4  3.000000000064292D+00,1.967916720207110D+00,
     5  1.290898739196919D+00,8.467937376294394D-01,
     6  5.554731849268231D-01,3.643749893929288D-01,
     7  2.390198780010692D-01,1.567904047850958D-01,
     8  1.028501530439043D-01,6.746684528092259D-02,
     9  4.425637762755096D-02,2.903095516854214D-02,
     *  1.904350069250380D-02,1.249200780752862D-02,
     1  8.194410344156378D-03,5.375305709291281D-03,
     2  3.526051327055254D-03,2.312991787510430D-03,
     3  1.517258404040883D-03,9.952793939943816D-04,
     4  6.528756535144124D-04,4.282683049003962D-04,
     5  2.809321193213504D-04,1.842836716272085D-04,
     6  1.208849728888974D-04,7.929718645652864D-05,
     7  5.201675302991735D-05,3.412154600460811D-05,
     8  2.238278696565042D-05,1.468248690394226D-05,
     9  9.631303823863041D-06,6.317867943904416D-06,
     *  4.144345987367384D-06,2.718575920742490D-06,
     1  1.783310336393839D-06,1.169802076037266D-06,
     2  7.673576882219802D-07,5.033653416566328D-07,
     3  3.301936907265093D-07,2.165978949540332D-07,
     4  1.420822063416645D-07,9.320198316426929D-08,
     5  6.113791367284429D-08,4.010477418400621D-08,
     6  2.630761855865202D-08,1.725706747670062D-08,
     7  1.132015720962134D-08,7.425708882703070D-09,
     8  4.871058889826626D-09,3.195279411316057D-09,
     9  2.096014592915617D-09,1.374927387632311D-09,
     *  9.019141983705824D-10,5.916306770386017D-10,
     1  3.880933004821025D-10,2.545784316486896D-10,
     2  1.669963840693437D-10,1.095449921370260D-10,
     3  7.185847387861310D-11,4.713716407661990D-11,
     4  3.092067110868187D-11,2.028310189080453D-11,
     5  1.330515178233777D-11,8.727810218776712D-12/
c
c      Weights:
c
      data ws2/
     1  1.132712418613569D-01,1.039781519819765D-01,
     2  8.779429247861777D-02,7.864843294617192D-02,
     3  9.028140582547439D-02,1.112366199369976D-01,
     4  1.373418689738553D-01,1.695743740305985D-01,
     5  2.093714651127932D-01,2.585084606969831D-01,
     6  3.191773254167143D-01,3.940844519642552D-01,
     7  4.865713912117643D-01,6.007639163584633D-01,
     8  7.417560705903483D-01,9.158374084751414D-01,
     9  1.130773568315111D+00,1.396152691481115D+00,
     *  1.723813142214257D+00,2.128371608207707D+00,
     1  2.627875140108186D+00,3.244606216948123D+00,
     2  4.006076750938849D+00,4.946255373244697D+00,
     3  6.107082749177255D+00,7.540342520415069D+00,
     4  9.309971332690674D+00,1.149491100245678D+01,
     5  1.419263005565029D+01,1.752347172393363D+01,
     6  2.163602236372084D+01,2.671373978290374D+01,
     7  3.298313715830809D+01,4.072388762068557D+01,
     8  5.028130025773344D+01,6.208172409466717D+01,
     9  7.665156722016549D+01,9.464077944945360D+01,
     *  1.168518460847607D+02,1.442755861944000D+02,
     1  1.781353523123698D+02,2.199416032871937D+02,
     2  2.715592847222849D+02,3.352910227872512D+02,
     3  4.139798426579559D+02,5.111359937492115D+02,
     4  6.310935393098144D+02,7.792036957464251D+02,
     5  9.620735463756387D+02,1.187860778459312D+03,
     6  1.466637591593856D+03,1.810840011020877D+03,
     7  2.235822649222833D+03,2.760543663892618D+03,
     8  3.408410467360203D+03,4.208323913390948D+03,
     9  5.195967542330845D+03,6.415399397232402D+03,
     *  7.921017421694510D+03,9.779986111467702D+03,
     1  1.207523266942365D+04,1.490914632643325D+04,
     2  1.840814585102590D+04,2.272831899639227D+04,
     3  2.806238545768478D+04,3.464829395074149D+04,
     4  4.277983692796404D+04,5.281975644085716D+04,
     5  6.521592579155512D+04,8.052132882537688D+04/

c
c Data for 92 nodes
c
c      Nodes:
c
      data ts3/
     1  6.509372555747694D+02,7.476427814199678D+01,
     2  2.877950902314416D+01,1.622115299509191D+01,
     3  1.096672320053904D+01,7.886193647868016D+00,
     4  5.713371790894660D+00,4.140060111955703D+00,
     5  3.000000034012745D+00,2.173881530318732D+00,
     6  1.575253608029940D+00,1.141471542990388D+00,
     7  8.271412772952638D-01,5.993690358642886D-01,
     8  4.343190855788693D-01,3.147194075754736D-01,
     9  2.280542315532488D-01,1.652542910706633D-01,
     *  1.197477485015930D-01,8.677247154005450D-02,
     1  6.287769001073307D-02,4.556288219799157D-02,
     2  3.301610210928961D-02,2.392436443591861D-02,
     3  1.733624435030312D-02,1.256231357696986D-02,
     4  9.102993659880470D-03,6.596276479983727D-03,
     5  4.779841121119103D-03,3.463602721694305D-03,
     6  2.509820631603322D-03,1.818684232797316D-03,
     7  1.317868029645551D-03,9.549630004742761D-04,
     8  6.919921495709358D-04,5.014363171914801D-04,
     9  3.633543778752842D-04,2.632964543700834D-04,
     *  1.907917682255641D-04,1.382529023079573D-04,
     1  1.001818089960298D-04,7.259445822205977D-05,
     2  5.260391436495583D-05,3.811822380519611D-05,
     3  2.762149937266466D-05,2.001528804484948D-05,
     4  1.450362097605055D-05,1.050971754174613D-05,
     5  7.615626778656827D-06,5.518490051602723D-06,
     6  3.998847820255488D-06,2.897673777097325D-06,
     7  2.099733147001638D-06,1.521523683800227D-06,
     8  1.102537394967566D-06,7.989285463565253D-07,
     9  5.789253268022686D-07,4.195050176850447D-07,
     *  3.039847312201323D-07,2.202755936652631D-07,
     1  1.596176787232526D-07,1.156633058482430D-07,
     2  8.381277328896371D-08,6.073301220965434D-08,
     3  4.400879039152958D-08,3.188996497064476D-08,
     4  2.310833487572133D-08,1.674492711934990D-08,
     5  1.213382892575285D-08,8.792501887263442D-09,
     6  6.371285595615458D-09,4.616806582658520D-09,
     7  3.345463494361177D-09,2.424213769416470D-09,
     8  1.756651174002375D-09,1.272917165827517D-09,
     9  9.223903549524058D-10,6.683891033294114D-10,
     *  4.843328979928250D-10,3.509607746326711D-10,
     1  2.543157124544314D-10,1.842840748576337D-10,
     2  1.335372471682437D-10,9.676471678064395D-11,
     3  7.011834216802829D-11,5.080965533016637D-11,
     4  3.681805641030697D-11,2.667936379256276D-11,
     5  1.933259172027100D-11,1.400892110983422D-11,
     6  1.015124477372272D-11,7.355867710843424D-12/
c
c      Weights:
c
      data ws3/
     1  8.808845491735100D-02,8.374243772296440D-02,
     2  7.529222400400451D-02,6.431570052426554D-02,
     3  5.874356808428163D-02,6.489545686081821D-02,
     4  7.602835582550453D-02,8.931199420232785D-02,
     5  1.049185959465078D-01,1.232523382116319D-01,
     6  1.447897689700186D-01,1.700907055186702D-01,
     7  1.998127851581190D-01,2.347285721576559D-01,
     8  2.757456366609112D-01,3.239301314574371D-01,
     9  3.805345053236298D-01,4.470300674031485D-01,
     *  5.251452337838528D-01,6.169104456448894D-01,
     1  7.247109439024794D-01,8.513487739502138D-01,
     2  1.000115619200686D+00,1.174878360254129D+00,
     3  1.380179586116297D+00,1.621355669119998D+00,
     4  1.904675472669441D+00,2.237503295780189D+00,
     5  2.628490292934338D+00,3.087799334678989D+00,
     6  3.627369142030553D+00,4.261224661021833D+00,
     7  5.005841689822333D+00,5.880575051496508D+00,
     8  6.908161689078510D+00,8.115311684899591D+00,
     9  9.533402037938890D+00,1.119929233705376D+01,
     *  1.315628417582644D+01,1.545524701984734D+01,
     1  1.815593805316532D+01,2.132855450735839D+01,
     2  2.505556099729392D+01,2.943383378403594D+01,
     3  3.457717708922686D+01,4.061928106883892D+01,
     4  4.771719678425690D+01,5.605541889872610D+01,
     5  6.585068286839804D+01,7.735759697471136D+01,
     6  9.087525894332660D+01,1.067550315939329D+02,
     7  1.254096766520518D+02,1.473240825845585D+02,
     8  1.730678677105410D+02,2.033101868015994D+02,
     9  2.388371249653405D+02,2.805721302392701D+02,
     *  3.296000161930491D+02,3.871951593614655D+02,
     1  4.548546239917407D+02,5.343370751564377D+02,
     2  6.277084915199933D+02,7.373958662025183D+02,
     3  8.662502911406629D+02,1.017621064202280D+03,
     4  1.195442753824414D+03,1.404337478600374D+03,
     5  1.649735026616250D+03,1.938013956587637D+03,
     6  2.276667412421736D+03,2.674497931870217D+03,
     7  3.141846327216048D+03,3.690860474965366D+03,
     8  4.335810877656278D+03,5.093461583010910D+03,
     9  5.983506096694728D+03,7.029079208903016D+03,
     *  8.257358269442924D+03,9.700269793573527D+03,
     1  1.139531938995283D+04,1.338656641848869D+04,
     2  1.572576914807403D+04,1.847373015550169D+04,
     3  2.170187674764617D+04,2.549411771989329D+04,
     4  2.994902446508635D+04,3.518239295807214D+04,
     5  4.133025356708278D+04,4.855240694881819D+04,
     6  5.703657773873328D+04,6.700329405808861D+04/
      
c        
c        
      if (eps .ge. 0.9d-3) then
         n=26
         do j =1,n
            ts(j) = ts0(j)
            ws(j) = ws0(j)
         enddo
      elseif (eps.ge.0.9d-6) then
         n=48
         do j =1,n
            ts(j) = ts1(j)
            ws(j) = ws1(j)
         enddo
      elseif (eps.ge.0.9d-9) then
         n=70
         do j =1,n
            ts(j) = ts2(j)
            ws(j) = ws2(j)
         enddo
      elseif (eps.ge.0.9d-12) then
         n=92
         do j =1,n
            ts(j) = ts3(j)
            ws(j) = ws3(j)
         enddo
      endif
c
      return
      end
