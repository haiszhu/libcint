function f = cgtofunc_h2o_ccpvtz(x,y,z)
% implement cgto, which calls libcint, libcgto, np_helper, etc...
% 
%
% h2o, ccpvtz
% mol_h2o = gto.M(
%     verbose = 0,
%     atom = '''
%     o    0    0.       0.
%     h    0    -0.757   0.587
%     h    0    0.757    0.587''',
%     basis = 'ccpvtz') 
%
% use parameters from pyscf/pyscf/gto/eval_gto.py
% 
%
% 11/26/24 Hai

% respect the shape of input variables
nd = 58;
[n1,n2,n3] = size(x);
f = zeros([n1 n2 n3 nd]); % need to be changed later

persistent ngrids shls_slice ao_loc non0tab atm bas env natm nbas nao triuidx triflag;
if isempty(ngrids)
  ngrids = 1; 
  shls_slice = [0, 21];
  ao_loc = [0,  2,  3,  4,  7, 10, 13, 18, 23, 30, 31, 32, 33, 36, 39, 44, 45, 46, 47, 50, 53, 58];
  % xyz = [0.0, 1.0, 1.0];  
  non0tab = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];
  atm = [
    8, 20, 1, 23, 0, 0,...
    1, 24, 1, 27, 0, 0,...
    1, 28, 1, 31, 0, 0];
  bas = [
    0,  0,  8,  2,  0, 32, 40,  0,...
    0,  0,  1,  1,  0, 56, 57,  0,...
    0,  0,  1,  1,  0, 58, 59,  0,...
    0,  1,  3,  1,  0, 60, 63,  0,...
    0,  1,  1,  1,  0, 66, 67,  0,...
    0,  1,  1,  1,  0, 68, 69,  0,...
    0,  2,  1,  1,  0, 70, 71,  0,...
    0,  2,  1,  1,  0, 72, 73,  0,...
    0,  3,  1,  1,  0, 74, 75,  0,...
    1,  0,  3,  1,  0, 76, 79,  0,...
    1,  0,  1,  1,  0, 82, 83,  0,...
    1,  0,  1,  1,  0, 84, 85,  0,...
    1,  1,  1,  1,  0, 86, 87,  0,...
    1,  1,  1,  1,  0, 88, 89,  0,...
    1,  2,  1,  1,  0, 90, 91,  0,...
    2,  0,  3,  1,  0, 76, 79,  0,...
    2,  0,  1,  1,  0, 82, 83,  0,...
    2,  0,  1,  1,  0, 84, 85,  0,...
    2,  1,  1,  1,  0, 86, 87,  0,...
    2,  1,  1,  1,  0, 88, 89,  0,...
    2,  2,  1,  1,  0, 90, 91,  0];
  env = [
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00, -1.43052268e+00,  1.10926924e+00,  0.00000000e+00, ...
    0.00000000e+00,  1.43052268e+00,  1.10926924e+00,  0.00000000e+00, ...
    1.53300000e+04,  2.29900000e+03,  5.22400000e+02,  1.47300000e+02, ...
    4.75500000e+01,  1.67600000e+01,  6.20700000e+00,  6.88200000e-01, ...
    1.81067529e+00,  3.37486577e+00,  5.72265412e+00,  8.66150357e+00, ...
    1.08070276e+01,  9.28179538e+00,  3.56346173e+00, -1.59395830e-02, ...
   -6.86527364e-01, -1.28759909e+00, -2.19507417e+00, -3.43047366e+00, ...
   -4.58719692e+00, -4.89805685e+00, -2.99457591e+00,  1.97563931e+00, ...
    1.75200000e+00,  3.84738459e+00,  2.38400000e-01,  8.61975084e-01, ...
    3.44600000e+01,  7.74900000e+00,  2.28000000e+00,  1.00262994e+01, ...
    9.72213774e+00,  6.55849668e+00,  7.15600000e-01,  1.92009319e+00, ...
    2.14000000e-01,  4.24621137e-01,  2.31400000e+00,  1.13283134e+01, ...
    6.45000000e-01,  1.21132000e+00,  1.42800000e+00,  4.39692268e+00, ...
    3.38700000e+01,  5.09500000e+00,  1.15900000e+00,  9.04334519e-01, ...
    1.63100455e+00,  2.40491525e+00,  3.25800000e-01,  1.08950276e+00, ...
    1.02700000e-01,  4.58345379e-01,  1.40700000e+00,  4.47045795e+00, ...
    3.88000000e-01,  8.93354953e-01,  1.05700000e+00,  2.87515071e+00 ...
  ];
  natm = numel(atm)/6;
  nbas = numel(bas)/8;
  nao = ao_loc(shls_slice(2)+1) - ao_loc(shls_slice(1)+1);
end

% nx,ny,nz,nd
for ix = 1:n1
  for iy = 1:n2
    for iz = 1:n3
      xyz = [x(ix,iy,iz); y(ix,iy,iz); z(ix,iy,iz)];
      fi = zeros(nd,1);
      fi = GTOval_h2o_ccpvtz_mwrap_mex(ngrids, shls_slice, ao_loc, fi, xyz, non0tab, atm, natm, bas, nbas, env);
      f(ix,iy,iz,:) = fi;
    end
  end
end

end