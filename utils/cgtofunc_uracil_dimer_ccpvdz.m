function f = cgtofunc_uracil_dimer_ccpvdz(x,y,z)
% implement cgto, which calls libcint, libcgto, np_helper, etc...
% 
%
% uracil_dimer, ccpvdz
% geom='''
%     O    -1.4663316    1.0121693    0.0000000
%     C    -0.6281464    1.9142678    0.0000000
%     N     0.7205093    1.6882688    0.0000000
%     C     1.6367290    2.7052764    0.0000000
%     C     1.2769036    4.0061763    0.0000000
%     C    -0.1286005    4.3621549    0.0000000
%     N    -0.9777230    3.2396433    0.0000000
%     O    -0.5972229    5.4864066    0.0000000
%     H     2.0103504    4.7938642    0.0000000
%     H     1.0232515    0.7061820    0.0000000
%     H    -1.9700268    3.4323850    0.0000000
%     H     2.6690620    2.3883417    0.0000000
%     O     1.4663316   -1.0121693    0.0000000
%     C     0.6281464   -1.9142678    0.0000000
%     N    -0.7205093   -1.6882688    0.0000000
%     C    -1.6367290   -2.7052764    0.0000000
%     C    -1.2769036   -4.0061763    0.0000000
%     C     0.1286005   -4.3621549    0.0000000
%     N     0.9777230   -3.2396433    0.0000000
%     O     0.5972229   -5.4864066    0.0000000
%     H    -2.0103504   -4.7938642    0.0000000
%     H    -1.0232515   -0.7061820    0.0000000
%     H     1.9700268   -3.4323850    0.0000000
%     H    -2.6690620   -2.3883417    0.0000000
%     '''
% 
% mol_uracil_dimer = gto.M(
%         verbose=7, 
%         atom=geom, 
%         basis='ccpvdz')
%
% use parameters from pyscf/pyscf/gto/eval_gto.py
% 
%
% 01/23/25 Hai

% respect the shape of input variables
nd = 264;
[n1,n2,n3] = size(x);
f = zeros([n1 n2 n3 nd]); % need to be changed later

persistent ngrids shls_slice ao_loc non0tab atm bas env natm nbas nao triuidx triflag;
if isempty(ngrids)
  % ngrids = 1; 
  shls_slice = [0, 104];
  ao_loc = [ 
     0,   2,   3,   6,   9,  14,  16,  17,  20,  23,  28,  30,  31, ...
    34,  37,  42,  44,  45,  48,  51,  56,  58,  59,  62,  65,  70, ...
    72,  73,  76,  79,  84,  86,  87,  90,  93,  98, 100, 101, 104, ...
   107, 112, 113, 114, 117, 118, 119, 122, 123, 124, 127, 128, 129, ...
   132, 134, 135, 138, 141, 146, 148, 149, 152, 155, 160, 162, 163, ...
   166, 169, 174, 176, 177, 180, 183, 188, 190, 191, 194, 197, 202, ...
   204, 205, 208, 211, 216, 218, 219, 222, 225, 230, 232, 233, 236, ...
   239, 244, 245, 246, 249, 250, 251, 254, 255, 256, 259, 260, 261, ...
   264];
  non0tab = [
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];
  atm = [
    8,  20,   1,  23,   0,   0, ...
    6,  24,   1,  27,   0,   0, ...
    7,  28,   1,  31,   0,   0, ...
    6,  32,   1,  35,   0,   0, ...
    6,  36,   1,  39,   0,   0, ...
    6,  40,   1,  43,   0,   0, ...
    7,  44,   1,  47,   0,   0, ...
    8,  48,   1,  51,   0,   0, ...
    1,  52,   1,  55,   0,   0, ...
    1,  56,   1,  59,   0,   0, ...
    1,  60,   1,  63,   0,   0, ...
    1,  64,   1,  67,   0,   0, ...
    8,  68,   1,  71,   0,   0, ...
    6,  72,   1,  75,   0,   0, ...
    7,  76,   1,  79,   0,   0, ...
    6,  80,   1,  83,   0,   0, ...
    6,  84,   1,  87,   0,   0, ...
    6,  88,   1,  91,   0,   0, ...
    7,  92,   1,  95,   0,   0, ...
    8,  96,   1,  99,   0,   0, ...
    1, 100,   1, 103,   0,   0, ...
    1, 104,   1, 107,   0,   0, ...
    1, 108,   1, 111,   0,   0, ...
    1, 112,   1, 115,   0,   0];
  bas = [
    0,   0,   8,   2,   0, 152, 160,   0, ...
    0,   0,   1,   1,   0, 176, 177,   0, ...
    0,   1,   3,   1,   0, 178, 181,   0, ...
    0,   1,   1,   1,   0, 184, 185,   0, ...
    0,   2,   1,   1,   0, 186, 187,   0, ...
    1,   0,   8,   2,   0, 116, 124,   0, ...
    1,   0,   1,   1,   0, 140, 141,   0, ...
    1,   1,   3,   1,   0, 142, 145,   0, ...
    1,   1,   1,   1,   0, 148, 149,   0, ...
    1,   2,   1,   1,   0, 150, 151,   0, ...
    2,   0,   8,   2,   0, 188, 196,   0, ...
    2,   0,   1,   1,   0, 212, 213,   0, ...
    2,   1,   3,   1,   0, 214, 217,   0, ...
    2,   1,   1,   1,   0, 220, 221,   0, ...
    2,   2,   1,   1,   0, 222, 223,   0, ...
    3,   0,   8,   2,   0, 116, 124,   0, ...
    3,   0,   1,   1,   0, 140, 141,   0, ...
    3,   1,   3,   1,   0, 142, 145,   0, ...
    3,   1,   1,   1,   0, 148, 149,   0, ...
    3,   2,   1,   1,   0, 150, 151,   0, ...
    4,   0,   8,   2,   0, 116, 124,   0, ...
    4,   0,   1,   1,   0, 140, 141,   0, ...
    4,   1,   3,   1,   0, 142, 145,   0, ...
    4,   1,   1,   1,   0, 148, 149,   0, ...
    4,   2,   1,   1,   0, 150, 151,   0, ...
    5,   0,   8,   2,   0, 116, 124,   0, ...
    5,   0,   1,   1,   0, 140, 141,   0, ...
    5,   1,   3,   1,   0, 142, 145,   0, ...
    5,   1,   1,   1,   0, 148, 149,   0, ...
    5,   2,   1,   1,   0, 150, 151,   0, ...
    6,   0,   8,   2,   0, 188, 196,   0, ...
    6,   0,   1,   1,   0, 212, 213,   0, ...
    6,   1,   3,   1,   0, 214, 217,   0, ...
    6,   1,   1,   1,   0, 220, 221,   0, ...
    6,   2,   1,   1,   0, 222, 223,   0, ...
    7,   0,   8,   2,   0, 152, 160,   0, ...
    7,   0,   1,   1,   0, 176, 177,   0, ...
    7,   1,   3,   1,   0, 178, 181,   0, ...
    7,   1,   1,   1,   0, 184, 185,   0, ...
    7,   2,   1,   1,   0, 186, 187,   0, ...
    8,   0,   3,   1,   0, 224, 227,   0, ...
    8,   0,   1,   1,   0, 230, 231,   0, ...
    8,   1,   1,   1,   0, 232, 233,   0, ...
    9,   0,   3,   1,   0, 224, 227,   0, ...
    9,   0,   1,   1,   0, 230, 231,   0, ...
    9,   1,   1,   1,   0, 232, 233,   0, ...
    10,   0,   3,   1,   0, 224, 227,   0, ...
    10,   0,   1,   1,   0, 230, 231,   0, ...
    10,   1,   1,   1,   0, 232, 233,   0, ...
    11,   0,   3,   1,   0, 224, 227,   0, ...
    11,   0,   1,   1,   0, 230, 231,   0, ...
    11,   1,   1,   1,   0, 232, 233,   0, ...
    12,   0,   8,   2,   0, 152, 160,   0, ...
    12,   0,   1,   1,   0, 176, 177,   0, ...
    12,   1,   3,   1,   0, 178, 181,   0, ...
    12,   1,   1,   1,   0, 184, 185,   0, ...
    12,   2,   1,   1,   0, 186, 187,   0, ...
    13,   0,   8,   2,   0, 116, 124,   0, ...
    13,   0,   1,   1,   0, 140, 141,   0, ...
    13,   1,   3,   1,   0, 142, 145,   0, ...
    13,   1,   1,   1,   0, 148, 149,   0, ...
    13,   2,   1,   1,   0, 150, 151,   0, ...
    14,   0,   8,   2,   0, 188, 196,   0, ...
    14,   0,   1,   1,   0, 212, 213,   0, ...
    14,   1,   3,   1,   0, 214, 217,   0, ...
    14,   1,   1,   1,   0, 220, 221,   0, ...
    14,   2,   1,   1,   0, 222, 223,   0, ...
    15,   0,   8,   2,   0, 116, 124,   0, ...
    15,   0,   1,   1,   0, 140, 141,   0, ...
    15,   1,   3,   1,   0, 142, 145,   0, ...
    15,   1,   1,   1,   0, 148, 149,   0, ...
    15,   2,   1,   1,   0, 150, 151,   0, ...
    16,   0,   8,   2,   0, 116, 124,   0, ...
    16,   0,   1,   1,   0, 140, 141,   0, ...
    16,   1,   3,   1,   0, 142, 145,   0, ...
    16,   1,   1,   1,   0, 148, 149,   0, ...
    16,   2,   1,   1,   0, 150, 151,   0, ...
    17,   0,   8,   2,   0, 116, 124,   0, ...
    17,   0,   1,   1,   0, 140, 141,   0, ...
    17,   1,   3,   1,   0, 142, 145,   0, ...
    17,   1,   1,   1,   0, 148, 149,   0, ...
    17,   2,   1,   1,   0, 150, 151,   0, ...
    18,   0,   8,   2,   0, 188, 196,   0, ...
    18,   0,   1,   1,   0, 212, 213,   0, ...
    18,   1,   3,   1,   0, 214, 217,   0, ...
    18,   1,   1,   1,   0, 220, 221,   0, ...
    18,   2,   1,   1,   0, 222, 223,   0, ...
    19,   0,   8,   2,   0, 152, 160,   0, ...
    19,   0,   1,   1,   0, 176, 177,   0, ...
    19,   1,   3,   1,   0, 178, 181,   0, ...
    19,   1,   1,   1,   0, 184, 185,   0, ...
    19,   2,   1,   1,   0, 186, 187,   0, ...
    20,   0,   3,   1,   0, 224, 227,   0, ...
    20,   0,   1,   1,   0, 230, 231,   0, ...
    20,   1,   1,   1,   0, 232, 233,   0, ...
    21,   0,   3,   1,   0, 224, 227,   0, ...
    21,   0,   1,   1,   0, 230, 231,   0, ...
    21,   1,   1,   1,   0, 232, 233,   0, ...
    22,   0,   3,   1,   0, 224, 227,   0, ...
    22,   0,   1,   1,   0, 230, 231,   0, ...
    22,   1,   1,   1,   0, 232, 233,   0, ...
    23,   0,   3,   1,   0, 224, 227,   0, ...
    23,   0,   1,   1,   0, 230, 231,   0, ...
    23,   1,   1,   1,   0, 232, 233,   0];
  env = [
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
   -2.77096513e+00,  1.91272277e+00,  0.00000000e+00,  0.00000000e+00, ...
   -1.18702466e+00,  3.61744187e+00,  0.00000000e+00,  0.00000000e+00, ...
    1.36156525e+00,  3.19036566e+00,  0.00000000e+00,  0.00000000e+00, ...
    3.09296955e+00,  5.11223149e+00,  0.00000000e+00,  0.00000000e+00, ...
    2.41299809e+00,  7.57057601e+00,  0.00000000e+00,  0.00000000e+00, ...
   -2.43019724e-01,  8.24327807e+00,  0.00000000e+00,  0.00000000e+00, ...
   -1.84762870e+00,  6.12203858e+00,  0.00000000e+00,  0.00000000e+00, ...
   -1.12858772e+00,  1.03678059e+01,  0.00000000e+00,  0.00000000e+00, ...
    3.79901167e+00,  9.05909042e+00,  0.00000000e+00,  0.00000000e+00, ...
    1.93366509e+00,  1.33449057e+00,  0.00000000e+00,  0.00000000e+00, ...
   -3.72281111e+00,  6.48626760e+00,  0.00000000e+00,  0.00000000e+00, ...
    5.04379619e+00,  4.51331170e+00,  0.00000000e+00,  0.00000000e+00, ...
    2.77096513e+00, -1.91272277e+00,  0.00000000e+00,  0.00000000e+00, ...
    1.18702466e+00, -3.61744187e+00,  0.00000000e+00,  0.00000000e+00, ...
   -1.36156525e+00, -3.19036566e+00,  0.00000000e+00,  0.00000000e+00, ...
   -3.09296955e+00, -5.11223149e+00,  0.00000000e+00,  0.00000000e+00, ...
   -2.41299809e+00, -7.57057601e+00,  0.00000000e+00,  0.00000000e+00, ...
    2.43019724e-01, -8.24327807e+00,  0.00000000e+00,  0.00000000e+00, ...
    1.84762870e+00, -6.12203858e+00,  0.00000000e+00,  0.00000000e+00, ...
    1.12858772e+00, -1.03678059e+01,  0.00000000e+00,  0.00000000e+00, ...
   -3.79901167e+00, -9.05909042e+00,  0.00000000e+00,  0.00000000e+00, ...
   -1.93366509e+00, -1.33449057e+00,  0.00000000e+00,  0.00000000e+00, ...
    3.72281111e+00, -6.48626760e+00,  0.00000000e+00,  0.00000000e+00, ...
   -5.04379619e+00, -4.51331170e+00,  0.00000000e+00,  0.00000000e+00, ...
    6.66500000e+03,  1.00000000e+03,  2.28000000e+02,  6.47100000e+01, ...
    2.10600000e+01,  7.49500000e+00,  2.79700000e+00,  5.21500000e-01, ...
    1.28887278e+00,  2.39276234e+00,  4.01148824e+00,  5.85976509e+00, ...
    6.81976662e+00,  5.13046805e+00,  1.55679276e+00,  2.35587606e-02, ...
   -5.46552977e-01, -1.04144203e+00, -1.70473124e+00, -2.69921437e+00, ...
   -3.19078522e+00, -3.44781747e+00, -1.39684233e+00,  1.69586408e+00, ...
    1.59600000e-01,  6.37954477e-01,  9.43900000e+00,  2.00200000e+00, ...
    5.45600000e-01,  2.75016415e+00,  2.17593660e+00,  1.04017442e+00, ...
    1.51700000e-01,  2.76195354e-01,  5.50000000e-01,  9.16566738e-01, ...
    1.17200000e+04,  1.75900000e+03,  4.00800000e+02,  1.13700000e+02, ...
    3.70300000e+01,  1.32700000e+01,  5.02500000e+00,  1.01300000e+00, ...
    2.01954000e+00,  3.75176051e+00,  6.29675240e+00,  9.21467523e+00, ...
    1.07298897e+01,  7.87818279e+00,  2.29637501e+00,  3.94147511e-02, ...
   -8.94856161e-01, -1.70329657e+00, -2.78735973e+00, -4.44591655e+00, ...
   -5.28622990e+00, -5.71024998e+00, -1.94898449e+00,  2.79438767e+00, ...
    3.02300000e-01,  1.03001520e+00,  1.77000000e+01,  3.85400000e+00, ...
    1.04600000e+00,  6.63856461e+00,  5.25433167e+00,  2.28748174e+00, ...
    2.75300000e-01,  5.81757722e-01,  1.18500000e+00,  3.51185438e+00, ...
    9.04600000e+03,  1.35700000e+03,  3.09300000e+02,  8.77300000e+01, ...
    2.85600000e+01,  1.02100000e+01,  3.83800000e+00,  7.46600000e-01, ...
    1.63952511e+00,  3.04243049e+00,  5.10397088e+00,  7.47046862e+00, ...
    8.69498936e+00,  6.46916279e+00,  1.92651664e+00,  3.13141682e-02, ...
   -7.14731953e-01, -1.36022624e+00, -2.22569718e+00, -3.54336401e+00, ...
   -4.19727941e+00, -4.54726296e+00, -1.68246433e+00,  2.22075187e+00, ...
    2.24800000e-01,  8.24825833e-01,  1.35500000e+01,  2.91700000e+00, ...
    7.97300000e-01,  4.46751132e+00,  3.56393896e+00,  1.65512513e+00, ...
    2.18500000e-01,  4.35811508e-01,  8.17000000e-01,  1.83196843e+00, ...
    1.30100000e+01,  1.96200000e+00,  4.44600000e-01,  5.79764064e-01, ...
    9.83419580e-01,  1.11930215e+00,  1.22000000e-01,  5.21536727e-01, ...
    7.27000000e-01,  1.95840453e+00];
  natm = numel(atm)/6;
  nbas = numel(bas)/8;
  nao = ao_loc(shls_slice(2)+1) - ao_loc(shls_slice(1)+1);
end

if 1 % 2025 version
  ngrids = n1*n2*n3;
  xyz = [x(:), y(:), z(:)]';
  xyz = xyz(:);
  fi = zeros([nd ngrids]); 
  fi = GTOval_uracil_dimer_ccpvdz_mwrap_mex(ngrids, shls_slice, ao_loc, fi, xyz, non0tab, atm, natm, bas, nbas, env);
  f = reshape(fi,[nd ngrids])';
  f = reshape(f,[n1 n2 n3 nd]);
end
