function f = cgtofunc_nh3_dimer_aug_ccpvdz(x,y,z)
% implement cgto, which calls libcint, libcgto, np_helper, etc...
% 
%
% nh3_dimer, aug-ccpvdz
% geom='''
%         N  -1.578718  -0.046611   0.000000 
%         H  -2.158621   0.136396  -0.809565
%         H  -2.158621   0.136396   0.809565
%         H  -0.849471   0.658193   0.000000
%         N   1.578718   0.046611   0.000000
%         H   2.158621  -0.136396  -0.809565
%         H   0.849471  -0.658193   0.000000
%         H   2.158621  -0.136396   0.809565
%         '''
% 
% mol_nh3_dimer = gto.M(
%         verbose=7, 
%         atom=geom, 
%         basis='aug-ccpvdz')
%
% use parameters from pyscf/pyscf/gto/eval_gto.py
% 
%
% 01/22/25 Hai

% respect the shape of input variables
nd = 100;
[n1,n2,n3] = size(x);
f = zeros([n1 n2 n3 nd]); % need to be changed later

persistent ngrids shls_slice ao_loc non0tab atm bas env natm nbas nao triuidx triflag;
if isempty(ngrids)
  % ngrids = 1; 
  shls_slice = [0, 46];
  ao_loc = [ 0,   2,   3,   4,   7,  10,  13,  18,  23,  24,  25,  26,  29, 32,  33,  34,  35,  38,  41,  42,  43,  44,  47,  50,  52,  53, 54,  57,  60,  63,  68,  73,  74,  75,  76,  79,  82,  83,  84, 85,  88,  91,  92,  93,  94,  97, 100];
  non0tab = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];
  atm = [
    7, 20,  1, 23,  0,  0,...
    1, 24,  1, 27,  0,  0,...
    1, 28,  1, 31,  0,  0,...
    1, 32,  1, 35,  0,  0,...
    7, 36,  1, 39,  0,  0,...
    1, 40,  1, 43,  0,  0,...
    1, 44,  1, 47,  0,  0,...
    1, 48,  1, 51,  0,  0];
  bas = [
    0,   0,   8,   2,   0,  66,  74,   0,...
    0,   0,   1,   1,   0,  90,  91,   0,...
    0,   0,   1,   1,   0,  92,  93,   0,...
    0,   1,   3,   1,   0,  94,  97,   0,...
    0,   1,   1,   1,   0, 100, 101,   0,...
    0,   1,   1,   1,   0, 102, 103,   0,...
    0,   2,   1,   1,   0, 104, 105,   0,...
    0,   2,   1,   1,   0, 106, 107,   0,...
    1,   0,   3,   1,   0,  52,  55,   0,...
    1,   0,   1,   1,   0,  58,  59,   0,...
    1,   0,   1,   1,   0,  60,  61,   0,...
    1,   1,   1,   1,   0,  62,  63,   0,...
    1,   1,   1,   1,   0,  64,  65,   0,...
    2,   0,   3,   1,   0,  52,  55,   0,...
    2,   0,   1,   1,   0,  58,  59,   0,...
    2,   0,   1,   1,   0,  60,  61,   0,...
    2,   1,   1,   1,   0,  62,  63,   0,...
    2,   1,   1,   1,   0,  64,  65,   0,...
    3,   0,   3,   1,   0,  52,  55,   0,...
    3,   0,   1,   1,   0,  58,  59,   0,...
    3,   0,   1,   1,   0,  60,  61,   0,...
    3,   1,   1,   1,   0,  62,  63,   0,...
    3,   1,   1,   1,   0,  64,  65,   0,...
    4,   0,   8,   2,   0,  66,  74,   0,...
    4,   0,   1,   1,   0,  90,  91,   0,...
    4,   0,   1,   1,   0,  92,  93,   0,...
    4,   1,   3,   1,   0,  94,  97,   0,...
    4,   1,   1,   1,   0, 100, 101,   0,...
    4,   1,   1,   1,   0, 102, 103,   0,...
    4,   2,   1,   1,   0, 104, 105,   0,...
    4,   2,   1,   1,   0, 106, 107,   0,...
    5,   0,   3,   1,   0,  52,  55,   0,...
    5,   0,   1,   1,   0,  58,  59,   0,...
    5,   0,   1,   1,   0,  60,  61,   0,...
    5,   1,   1,   1,   0,  62,  63,   0,...
    5,   1,   1,   1,   0,  64,  65,   0,...
    6,   0,   3,   1,   0,  52,  55,   0,...
    6,   0,   1,   1,   0,  58,  59,   0,...
    6,   0,   1,   1,   0,  60,  61,   0,...
    6,   1,   1,   1,   0,  62,  63,   0,...
    6,   1,   1,   1,   0,  64,  65,   0,...
    7,   0,   3,   1,   0,  52,  55,   0,...
    7,   0,   1,   1,   0,  58,  59,   0,...
    7,   0,   1,   1,   0,  60,  61,   0,...
    7,   1,   1,   1,   0,  62,  63,   0,...
    7,   1,   1,   1,   0,  64,  65,   0];
  env = [
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
    0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...
   -2.98334465e+00, -8.80820244e-02,  0.00000000e+00,  0.00000000e+00, ...
   -4.07920250e+00,  2.57751084e-01, -1.52985613e+00,  0.00000000e+00, ...
   -4.07920250e+00,  2.57751084e-01,  1.52985613e+00,  0.00000000e+00, ...
   -1.60526754e+00,  1.24380451e+00,  0.00000000e+00,  0.00000000e+00, ...
    2.98334465e+00,  8.80820244e-02,  0.00000000e+00,  0.00000000e+00, ...
    4.07920250e+00, -2.57751084e-01, -1.52985613e+00,  0.00000000e+00, ...
    1.60526754e+00, -1.24380451e+00,  0.00000000e+00,  0.00000000e+00, ...
    4.07920250e+00, -2.57751084e-01,  1.52985613e+00,  0.00000000e+00, ...
    1.30100000e+01,  1.96200000e+00,  4.44600000e-01,  5.79764064e-01, ...
    9.83419580e-01,  1.11930215e+00,  1.22000000e-01,  5.21536727e-01, ...
    2.97400000e-02,  1.80934235e-01,  7.27000000e-01,  1.95840453e+00, ...
    1.41000000e-01,  2.52062526e-01,  9.04600000e+03,  1.35700000e+03, ...
    3.09300000e+02,  8.77300000e+01,  2.85600000e+01,  1.02100000e+01, ...
    3.83800000e+00,  7.46600000e-01,  1.63952511e+00,  3.04243049e+00, ...
    5.10397088e+00,  7.47046862e+00,  8.69498936e+00,  6.46916279e+00, ...
    1.92651664e+00,  3.13141682e-02, -7.14731953e-01, -1.36022624e+00, ...
   -2.22569718e+00, -3.54336401e+00, -4.19727941e+00, -4.54726296e+00, ...
   -1.68246433e+00,  2.22075187e+00,  2.24800000e-01,  8.24825833e-01, ...
    6.12400000e-02,  3.11022216e-01,  1.35500000e+01,  2.91700000e+00, ...
    7.97300000e-01,  4.46751132e+00,  3.56393896e+00,  1.65512513e+00, ...
    2.18500000e-01,  4.35811508e-01,  5.61100000e-02,  7.96681493e-02, ...
    8.17000000e-01,  1.83196843e+00,  2.30000000e-01,  1.99321019e-01];
  natm = numel(atm)/6;
  nbas = numel(bas)/8;
  nao = ao_loc(shls_slice(2)+1) - ao_loc(shls_slice(1)+1);
end

if 1 % 2025 version
  ngrids = n1*n2*n3;
  xyz = [x(:), y(:), z(:)]';
  xyz = xyz(:);
  fi = zeros([nd ngrids]); 
  fi = GTOval_nh3_dimer_aug_ccpvdz_mwrap_mex(ngrids, shls_slice, ao_loc, fi, xyz, non0tab, atm, natm, bas, nbas, env);
  f = reshape(fi,[nd ngrids])';
  f = reshape(f,[n1 n2 n3 nd]);
end
